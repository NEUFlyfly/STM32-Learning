# GPIO简介

- GPIO（General Purpose Input Output）通用输入输出口。

- 可配置为8种输入输出模式。


- 引脚电平：0V~3.3V，部分引脚可容忍5V。（0v就是低电平是数据0，3.3v是高电平是数据1。容忍5v意思是可以在这个端口输入5v的点电压，也认为是高电平，但是对于输出而言，最大就只能输出3.3v，因为供电就只有3.3v，具体哪些端口能容忍5v，可以参考一下stm32的引脚定义，带FT的就是可以容忍5v，不带FT的就只能接入3.3v电压）


- 输出模式下可控制端口输出高低电平，用以驱动LED、控制蜂鸣器、模拟通信协议输出时序等。（后面文章显示的LED和蜂鸣器的程序现象，就使用到了GPIO的输出模式。另外在其他的应用场景，只要是可以用高低电平来进行控制地方都可以用GPIO来完成；如果控制的是功率比较大的设备，只需要再加入驱动电路即可；此外，还可以用GPIO来模拟通信协议，比如I2CC、spi或某个芯片特定协议，我们都可以用GPIO的输出模式来模拟其中的输出时序部分）


## GPIO的基本结构

- 如下，为GPIO的整体构造，其中左边的是APB2外设总线；在stm32中所有的GPIO都是挂载在APB2外设总线上的，其中GPIO外设的名称都是按照GPIOA、GPIOB等等这样来命名的，每个GPIO外设，总共有16个引脚，编号是从0到15，GPIO的第0号引脚，我们一般把它称为PA0，接着第一号就是PA1..PA15以此来命名；

在每个GPIO模块内，组要包含了寄存器和驱动器，寄存器就是一段特殊的存储器，内核可以通过APB2总线对寄存器进行读写，这样就可以完成输出电平和读取电平的功能了，寄存器的每一位对应一个引脚，其中，输出寄存器写1，对应的引脚就会输出高电平，写0就会输出低电平，输入寄存器读取为1，就证明对应的端口目前是高电平，读取为0，就是低电平；

因为STM32是32位单片机，所以STM32内部的寄存器都是32位的，但这个端口只有16位，所以这个寄存器只有低16位对应的有端口，高16位是没有用的；

驱动器是用来增加信号的驱动能力，寄存器只负责存储数据，如果要进行点灯这样的操作，还是需要驱动器来负责增大驱动能力。

如下，这些就是GPIO的整体基本结构了。



GPIO位结构（每一位的具体电路结构）
如下图为，stm32参考手册中的GPIO位结构的电路图。



左边三个就是寄存器，中间部分是驱动器，右边是某一个IO口的引脚，如下三个红圈里的内容。



 整体结构可以分为两个部分，上面是输入部分，下面是输出部分。



一、首先，输入部分

1.首先是这个IO引脚，这里接了两个保护二极管，这个是对输入电压进行限幅的，上面二极管接VDD，3.3V，下面二极管接VSS，0V；如果输入电压比3.3v还要高，那上方这个二极管就会导通，输入电压产生的电流就会直接流入VDD而不会流入内部电路，这样就可以避免过高的电压对内部电路产生伤害。



如果输入电压比0v还要低，这个电压是相对与VSS的电压，所以是可以有负电压的，那这时下方这个二极管就会导通，电流会从VSS直接流出来，电流会从VSS直接流出去，而不会从内部电路汲取电流，也是可以保护内部电路的。



 如果输入电压在0-3.3v之间，那两个保护二极管均不会导通，这时二极管对电路没有影响，这就是保护二极管的用途

2.上拉和下拉电阻

上拉和下拉的作用：是为了给输入提供一个默认的输入电平，因为对应一个数字的端口，输入不是高电平就是低电平；如果输入引脚哈都不接，这时输入就会处于一个浮空状态，引脚的输入电平极易受外界干扰而改变；为了避免引脚悬空导致的输入数据不稳定，我们就需要在这里加上上拉或下拉电阻

上拉电阻至VDD，下拉电阻至VSS，这个开关是可以通过程序进行配置的。

上面导通、下面断开，就是上拉输入模式；上面断开、下面导通，就是下拉输入模式；上面断开、下面断开，就是浮空输入模式。

如果接入上拉电阻，当引脚悬空时，还有上拉电阻来保证引脚的高电平，所以上拉输入是默认为高电平的输入模式，下拉也是同理。

上拉电阻和下拉电阻的阻值都是比较大的，是一种弱上拉和弱下拉 ，目的是尽量不影响正常的输入操作。



 3.TTL肖特基触发器

实际上这个应该是斯密特触发器（应该是一个翻译错误）。如下：


————————————————

                            版权声明：本文为博主原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接和本声明。

原文链接：https://blog.csdn.net/m0_61712829/article/details/132389014